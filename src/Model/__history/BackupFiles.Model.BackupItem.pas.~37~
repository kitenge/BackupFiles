unit BackupFiles.Model.BackupItem;

interface

uses
  BackupFiles.Controller.BackupItem,
  System.SysUtils;

type
  TBackupItem = class(TInterfacedObject, iBackupItem)
  private
    FCaminho: string;
    FTamanho: Int64;
    FUltimaModificacao: TDateTime;
    function Caminho(Value: string): iBackupItem; overload;
    function Caminho: string; overload;
    function Tamanho(Value: Int64): iBackupItem; overload;
    function Tamanho: Int64; overload;
    function UltimaModificacao(Value: TDateTime): iBackupItem; overload;
    function UltimaModificacao: TDateTime; overload;
  public
    constructor Create;
    destructor Destroy; override;
    function New: iBackupItem;
  published

  end;

implementation

{ TBackupItem }

function TBackupItem.Caminho(Value: string): iBackupItem;
begin
  Result := Self;
  if (Value <> '') then
    if FileExists(Value) then
      FCaminho := Value
    else
      raise Exception.Create('O Caminho selecionado não existe')
  else
    raise Exception.Create('Caminho de Arquivo Inválido');
end;

function TBackupItem.Caminho: string;
begin
  Result := Self.FCaminho;
end;

constructor TBackupItem.Create;
begin
  inherited;

end;

destructor TBackupItem.Destroy;
begin

  inherited;
end;

function TBackupItem.New: iBackupItem;
begin
  Result := TBackupItem.Create;
end;

function TBackupItem.Tamanho(Value: Int64): iBackupItem;
begin
  Result := Self;
  FTamanho := Value;
end;

function TBackupItem.Tamanho: Int64;
begin
  Result := FTamanho;
end;

function TBackupItem.UltimaModificacao(Value: TDateTime): iBackupItem;
begin
  Result := Self;
  FUltimaModificacao := Value;
end;

function TBackupItem.UltimaModificacao: TDateTime;
begin
   Result := FUltimaModificacao;
end;

end.
